!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t){e.exports=require("@actions/core")},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=require("source-map-support/register")},function(e,t){e.exports=require("fs")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeFile=t.makeDir=t.pathResolve=void 0;const n=r(3),o=r(14);function i(e,t){return o.resolve(e,t)}async function a(e,t){const{mkdir:r,stat:o}=n.promises;if("."==t)return!0;const a=i(e,t);try{if(!(await o(a)).isDirectory())throw new Error("not a directory: "+t)}catch(e){if("ENOENT"!=e.code)throw e;await r(a,{recursive:!0})}return!0}t.pathResolve=i,t.makeDir=a,t.writeFile=async function(e,t,r){const{writeFile:s}=n.promises,c=i(e,t),u=o.dirname(t);return await a(e,u),await s(c,r),!0}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.run=void 0,r(2);const n=r(0),o=r(6),i=r(15),a=r(16);async function s(e){try{const t=await i.loadInputs(),r=await o.loadConfig(e,t);n.startGroup("Setting mask values"),await a.prepareMask(r),n.endGroup(),n.startGroup("Exporting environment variables"),await a.prepareEnv(r),n.endGroup(),n.startGroup("Saving defined files"),await a.prepareFile(e,r),n.endGroup()}catch(e){n.setFailed(e)}}if(t.run=s,r.c[r.s]===e){s(process.cwd())}}).call(this,r(1)(e))},function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.loadConfigYaml=t.loadConfigWithGPGPassphrase=t.loadConfigFile=t.loadConfig=t.assertConfig=void 0;const s=i(r(7)),c=a(r(8)),u=a(r(9)),f=r(3),l=a(r(10)),p=a(r(11)),d=a(r(12)),y=r(13),v=r(4),g=["required","type"].reverse();function h(e){const t=(new c.default).compile(d.default);if(t(e),t.errors){const e=t.errors,r=l.default(e,"dataPath"),n=p.default(Object.keys(r),"length");for(const e of n){const t=r[e],n=p.default(t,e=>-g.indexOf(e.keyword));for(const e of n)throw new y.ConfigActionError(`${e.message} at ${e.dataPath}`)}}}async function b(e,t){const{readFile:r}=f.promises,n=v.pathResolve(e,t);return _(await r(n,"utf8"))}async function m(e,t,r){const{readFile:n}=f.promises,o=v.pathResolve(e,t),i=await n(o),{data:a}=await s.decrypt({message:await s.message.read(i),passwords:[r],format:"utf8"});return _(a)}async function _(e){const t=u.default.safeLoad(e);return h(t),t}t.assertConfig=h,t.loadConfig=async function(e,t){return t.gpgPassphrase?m(e,t.configFile,t.gpgPassphrase):b(e,t.configFile)},t.loadConfigFile=b,t.loadConfigWithGPGPassphrase=m,t.loadConfigYaml=_},function(e,t){e.exports=require("openpgp")},function(e,t){e.exports=require("ajv")},function(e,t){e.exports=require("js-yaml")},function(e,t){e.exports=require("lodash/groupBy")},function(e,t){e.exports=require("lodash/sortBy")},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema","type":"object","properties":{"env":{"type":"object","patternProperties":{"^[a-zA-Z_]+[a-zA-Z0-9_]*$":{"anyOf":[{"type":"string"},{"type":"object","required":["value"],"properties":{"value":{"type":"string"},"secret":{"type":"boolean","default":true}}}]}},"additionalProperties":false},"file":{"type":"object","patternProperties":{"^(.+)/([^/]+)$":{"type":"string"}}},"mask":{"type":"array","items":{"type":"string"}}}}')},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigActionError=t.ActionError=void 0;class n extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}t.ActionError=n;t.ConfigActionError=class extends n{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}},function(e,t){e.exports=require("path")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadInputs=void 0;const n=r(0);t.loadInputs=async function(){var e;let t={configFile:(e="config_file",n.getInput(e,{required:!0}))};const r=function(e){const t=n.getInput(e);if(""!=t)return t}("gpg_passphrase");return r&&(t={...t,gpgPassphrase:r}),t}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.prepareFile=t.prepareEnv=t.prepareMask=void 0;const o=r(0),i=n(r(17)),a=r(18),s=r(4);t.prepareMask=async function(e){if(e.mask){for(const t of e.mask)o.setSecret(a.replaceEnvVer(t));o.info("mask value count: "+e.mask.length)}},t.prepareEnv=async function(e){if(e.env)for(const t in e.env){const r=e.env[t];if(i.default(r)){const e=a.replaceEnvVer(r);o.setSecret(e),o.exportVariable(t,e),o.info(t+": *** (mask)")}else{const e=a.replaceEnvVer(r.value);o.exportVariable(t,e),!1===r.secret?o.info(`${t}: ${e}`):(o.setSecret(e),o.info(t+": *** (mask)"))}}},t.prepareFile=async function(e,t){if(t.file)for(const r in t.file){const n=t.file[r],i=a.replaceEnvVer(r);await s.writeFile(e,i,n)?o.info(`wrote "${r}"`):o.error(`could not write "${r}"`)}}},function(e,t){e.exports=require("lodash/isString")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceEnvVer=void 0;const n=/\$\{\s*([a-zA-Z_]+[a-zA-Z0-9_]*)\s*\}/g;t.replaceEnvVer=function(e){return e.replace(n,(e,t)=>process.env[t]||"")}}]);
//# sourceMappingURL=index.js.map